"use strict";const t={table:{t:t=>`<td>${t}</td>`,o:t=>`<th tabindex="0">${t}</th>`},i:{l:'<thead><tr class="header">',end:"</tr></thead>"},body:{l:"<tbody>",end:"</tbody>"},s:{l:"<tr>",end:"</tr>"},u:{l:"<tfoot>",end:"</tfoot>"},m:{g:'<img src="assets/silver_star.png" class="icon" alt="Silver" title="Silver" /><div class="sort-id">1 Silver</div>',v:'<img src="assets/gold_star.png" class="icon" alt="Gold" alt="Gold" title="Gold" /><div class="sort-id">2 Gold</div>',_:'<img src="assets/iridium_star.png" class="icon" alt="Iridium" title="Iridium" /><div class="sort-id">3 Iridium</div>'}};function file_opened(t){const s=t.target,d=new FileReader;d.onload=function(){const t=e(d.result);n(["items.min.xslt","items-to-csv.min.xslt"]).then((function(n){const s=o(e(n[0]),t),d=r(i(o(e(n[1]),s)));u(c(d),l(d)),m()}))},d.readAsText(s.files[0])}function e(t){return(new DOMParser).parseFromString(t,"text/xml")}function n(t){let e=[];for(let n=0;n<t.length;n++)e.push(fetch(t[n]).then(t=>t.text()));return Promise.all(e)}function o(t,e){const n=new XSLTProcessor;return n.importStylesheet(t),n.transformToFragment(e,new Document)}let csv_string;function i(t){return csv_string=t.firstChild.wholeText,csv_string}function r(t){return t.split("\n").map(t=>t.split(","))}function c(e){let n="";for(let o=1;o<e.length-1;o++){n+=t.s.l;for(let i=0;i<e[o].length;i++)n+=1!==i?t.table.t(d(e[o][i])):t.table.t(s(e[o][i]));n+=t.s.end}return n}function l(e){let n="";for(let o=0;o<e[0].length;o++)n+=t.table.o(e[0][o]);return n}function s(e){return e.replace(/Silver/,t.m.g).replace(/Gold/,t.m.v).replace(/Iridium/,t.m._)}function d(t){return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,"â€¯")}function u(e,n){document.querySelector("article").style.display="none";const o=document.getElementById("item_table"),i=o.tBodies[0],r=o.tHead,c=o.tFoot;i&&(r.remove(),i.remove(),c.remove()),o.insertAdjacentHTML("beforeend",t.i.l+n+t.i.end),o.insertAdjacentHTML("beforeend",t.body.l+e+t.body.end),o.insertAdjacentHTML("beforeend",t.u.l+t.u.end),f(),document.querySelector("article").style.removeProperty("display"),document.getElementById("filter").focus()}function a(t){const e=t.match(/\d/g);return e?Number(e.join("")):0}function f(){const e=document.getElementById("item_table").tBodies[0];let n=0,o=0;const i="filter_"+b;for(let t,r=0;t=e.rows[r];r++)t.classList.contains(i)||(o+=a(t.cells[3].textContent),n+=a(t.cells[5].textContent));let r="";r+=t.s.l,r+=t.table.t("Total")+t.table.t("")+t.table.t(""),r+=t.table.t(d(o)),r+=t.table.t(""),r+=t.table.t(d(n))+t.s.end;const c=document.querySelector("tfoot tr");c&&c.remove(),document.querySelector("tfoot").insertAdjacentHTML("afterbegin",r)}function m(){const t=document.getElementById("item_table"),e=new Tablesort(t);Tablesort.extend("number",t=>t.match(/\d/),(t,e)=>a(t)-a(e));const n=t.tHead.rows[0].cells;for(let t=0;t<n.length;t++)n[t].addEventListener("keydown",(function(t){"Enter"===t.key&&e.h(t.srcElement)}))}function download_as_csv(t){const e=document.createElement("a");e.setAttribute("href","data:text/csv;charset=utf-8,"+encodeURIComponent(t)),e.setAttribute("download","Stardew Valley Items.csv"),e.style.display="none",document.body.appendChild(e),e.click(),document.body.removeChild(e)}let b=1;function filter_table(){const t=document.getElementById("filter").value,e=document.getElementById("item_table").tBodies[0].rows,n=RegExp(t,"i"),o=b-1-1,i="filter_"+b,r="filter_"+o;for(let t=0;t<e.length;t++){let o=e[t];o.textContent.match(n)||o.classList.add(i),o.classList.remove(r)}const c=document.styleSheets[0];c.insertRule(`.${i} {display:none}`),o>=0&&c.deleteRule(1),f(),b++}