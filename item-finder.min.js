"use strict";let e,csv_string;function file_opened(u){const d=u.target,s=new FileReader;s.onload=function(){const u=t(s.result);n(["items.min.xslt","items-to-csv.min.xslt"]).then((function(n){let d=e.table();const s=o(t(n[0]),u),a=r(c(o(t(n[1]),s)));d=i(a,d),d=l(a,d),m(d),_()}))},s.readAsText(d.files[0])}function t(e){return(new DOMParser).parseFromString(e,"text/xml")}function n(e){let t=[];for(let n=0;n<e.length;n++)t.push(fetch(e[n]).then(e=>e.text()));return Promise.all(t)}function o(e,t){const n=new XSLTProcessor;return n.importStylesheet(e),n.transformToFragment(t,new Document)}function c(e){return csv_string=e.firstChild.wholeText,csv_string}function r(e){return e.split("\n").map(e=>e.split(","))}function u(e,t){return()=>e.appendChild(document.createTextNode(t))}function i(e,t){for(let n=1;n<e.length-1;n++){const o=t.insertRow();for(let t=0;t<e[n].length;t++){const c=o.insertCell();1!==t?u(c,s(e[n][t]))():c.appendChild(d(e[n][t]))}}return t}function l(t,n){let o=new DocumentFragment;for(let n=0;n<t[0].length;n++)o.append(e.t(t[0][n]));return n.tHead.appendChild(e.o(o)),n}function d(t){switch(t){case"Silver":return e.u();case"Gold":return e.i();case"Iridium":return e.l();default:return document.createTextNode("")}}function s(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,"â€¯")}window.onload=function(t){const n={table:document.getElementById("table_base"),s:document.getElementById("cell_base"),m:document.getElementById("row_base"),t:document.getElementById("header_cell_base"),o:document.getElementById("header_base"),u:document.getElementById("silver_base"),i:document.getElementById("gold_base"),l:document.getElementById("iridium_base")};e={table:()=>n.table.content.cloneNode(!0).firstElementChild,t:function(e){const t=n.t.content.cloneNode(!0);return t.firstElementChild.insertAdjacentHTML("beforeend",e),t},o:function(e){const t=n.o.content.cloneNode(!0);return t.firstElementChild.appendChild(e),t},u:()=>n.u.content.cloneNode(!0),i:()=>n.i.content.cloneNode(!0),l:()=>n.l.content.cloneNode(!0)}};let a=!1;function m(e){document.querySelector("article").style.display="none",a&&document.getElementById("item_table").remove(),e=b(e),document.getElementById("table_container").appendChild(e),document.querySelector("article").style.removeProperty("display"),a=!0,document.getElementById("filter").focus()}function f(e){const t=e.match(/\d/g);return t?Number(t.join("")):0}function b(e){const t=e.tFoot;let n=0,o=0;const c="filter_"+w;for(;t.rows[0];)t.rows[0].remove();for(let t,r=0;t=e.tBodies[0].rows[r];r++)t.classList.contains(c)||(o+=f(t.cells[3].textContent),n+=f(t.cells[5].textContent));const r=t.insertRow(),i=()=>u(r.insertCell(),"")();return u(r.insertCell(),"Total")(),i(),i(),u(r.insertCell(),s(o))(),i(),u(r.insertCell(),s(n))(),e}function _(){const e=document.getElementById("item_table"),t=new Tablesort(e);Tablesort.extend("number",e=>e.match(/\d/),(e,t)=>f(e)-f(t));const n=e.tHead.rows[0].cells;for(let e=0;e<n.length;e++)n[e].addEventListener("keydown",(function(e){"Enter"===e.key&&t._(e.srcElement)}))}function download_as_csv(e){const t=document.createElement("a");t.setAttribute("href","data:text/csv;charset=utf-8,"+encodeURIComponent(e)),t.setAttribute("download","Stardew Valley Items.csv"),t.style.display="none",document.body.appendChild(t),t.click(),document.body.removeChild(t)}let w=1;function filter_table(){const e=document.getElementById("filter").value,t=document.getElementById("item_table"),n=t.tBodies[0].rows,o=RegExp(e,"i"),c=w-1-1,r="filter_"+w,u="filter_"+c;for(let e=0;e<n.length;e++){let t=n[e];t.textContent.match(o)||t.classList.add(r),t.classList.remove(u)}const i=document.styleSheets[0];i.insertRule(`.${r} {display:none}`),c>=0&&i.deleteRule(1);b(t);w++}